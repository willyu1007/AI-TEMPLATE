# 系统边界 [模板]

> 定义系统的范围、依赖和约束

## 目标
明确系统的职责边界、外部依赖和非功能需求，避免范围蔓延。

## 适用场景
- 系统架构设计阶段
- 技术选型和评估
- 对外接口定义

## 使用说明
1. 在项目初期填写本文档
2. 随系统演进定期更新
3. 作为架构评审的参考依据
4. 与 PRD 和 DAG 保持一致

---

## 系统概述
[用 1-2 段话描述系统的核心功能和定位]

**示例**：
本系统是一个面向团队的任务管理平台，提供任务创建、分配、跟踪和报告生成功能。系统支持多租户，每个租户拥有独立的数据空间。

---

## 外部依赖

### 第三方服务
| 服务名称 | 用途 | SLA 要求 | 降级策略 |
|---------|------|---------|---------|
| OpenAI API | AI 辅助功能 | 可用性 99% | 禁用 AI 功能 |
| SendGrid | 邮件发送 | 可用性 99.9% | 队列重试 |
| Stripe | 支付处理 | 可用性 99.95% | 人工处理 |

### 外部系统
| 系统名称 | 接口类型 | 数据流向 | 认证方式 |
|---------|---------|---------|---------|
| CRM 系统 | REST API | 双向同步 | OAuth 2.0 |
| 企业 SSO | SAML 2.0 | 用户认证 | SAML |

### 基础设施依赖
```yaml
数据库：
  - PostgreSQL 16+
  - Redis 7+

中间件：
  - 消息队列：RabbitMQ / Kafka（可选）
  - 搜索引擎：Meilisearch（可选）

云服务：
  - 对象存储：AWS S3 / 阿里云 OSS
  - CDN：CloudFlare
```

---

## 入口与出口

### 系统入口
**用户入口**：
- Web 界面：https://app.example.com
- Mobile App（如有）
- API：https://api.example.com

**管理入口**：
- 管理后台：https://admin.example.com
- 监控面板：https://grafana.example.com

**开发入口**：
- 开发环境：http://localhost:3000
- API 文档：https://api.example.com/docs

### 系统出口
**数据导出**：
- 任务导出：CSV / Excel
- 报告导出：PDF
- 数据备份：JSON

**对外 API**：
```yaml
webhook:
  - 任务状态变更通知
  - 用户操作日志

openapi:
  - RESTful API (v1)
  - GraphQL (可选)
```

**第三方集成**：
- Webhook 回调：允许第三方订阅事件
- OAuth 2.0：支持第三方应用授权

---

## 系统边界

### ✅ 系统负责
[明确系统职责范围]

**示例**：
- 用户认证与授权
- 任务数据的 CRUD
- 任务状态流转
- 报告自动生成
- 数据持久化与备份
- API 访问控制

### ❌ 系统不负责
[明确边界外的职责]

**示例**：
- 邮件服务器维护（使用 SendGrid）
- 支付交易处理（使用 Stripe）
- 文件存储基础设施（使用云存储）
- 用户设备管理
- 企业 IT 基础设施

---

## 非功能需求

### 性能需求
```yaml
响应时间：
  - API: P95 < 200ms, P99 < 500ms
  - 页面加载: FCP < 1.5s, LCP < 2.5s

吞吐量：
  - 并发用户: 1000+
  - QPS: 10000+

资源限制：
  - 数据库连接池: 100
  - 内存使用: <2GB per instance
  - CPU: <70% 平均使用率
```

### 可用性需求
```yaml
SLA:
  - 可用性: 99.9% (月停机 <43分钟)
  - RTO: 1小时 (恢复时间目标)
  - RPO: 15分钟 (数据丢失容忍)

容灾：
  - 数据库：主从复制 + 自动故障转移
  - 应用：多实例部署 + 负载均衡
  - 备份：每日全量 + 实时增量
```

### 安全需求
```yaml
认证：
  - 密码策略：≥8位，含大小写+数字+特殊字符
  - 会话管理：JWT + Redis，过期时间 24h
  - MFA：支持两步验证（可选）

授权：
  - RBAC：基于角色的访问控制
  - 资源隔离：租户数据物理隔离

数据安全：
  - 传输加密：TLS 1.3
  - 存储加密：敏感字段 AES-256
  - 审计日志：所有操作可追溯

合规：
  - GDPR：支持数据导出和删除
  - 个人信息保护：符合地区法规
```

### 可扩展性需求
```yaml
垂直扩展：
  - 数据库：支持扩展到 1TB+
  - 缓存：支持 Redis Cluster

水平扩展：
  - 无状态设计：应用层可水平扩展
  - 分库分表：支持千万级数据

模块化：
  - 核心模块：用户、任务、报告
  - 扩展模块：可插拔的功能模块
```

### 可维护性需求
```yaml
文档：
  - API 文档自动生成
  - 每个模块有完整文档（8个必备）
  - 运维手册齐全

监控：
  - 日志聚合：ELK / Loki
  - 指标监控：Prometheus + Grafana
  - 告警：PagerDuty / 钉钉

部署：
  - 容器化：Docker
  - 编排：Kubernetes（生产）/ docker-compose（开发）
  - CI/CD：自动化测试 + 部署
```

---

## 数据量估算

### 当前预估
```yaml
用户：
  - 初期：1,000 用户
  - 1年后：10,000 用户
  - 3年后：100,000 用户

数据：
  - 任务数据：平均每用户 100 条/年
  - 日志数据：100GB/年
  - 附件数据：1TB/年

流量：
  - 日均 API 请求：100,000
  - 峰值 QPS：100
```

### 扩展计划
[描述当数据量增长时的应对策略]

---

## 技术约束

### 必须满足
- ✅ 支持主流浏览器（Chrome/Firefox/Safari 最新版本）
- ✅ 响应式设计（支持桌面和平板）
- ✅ 符合 WCAG 2.1 AA 级无障碍标准

### 不支持
- ❌ IE 浏览器
- ❌ 手机浏览器（移动端优化留待后续）
- ❌ 离线模式

---

## 接口清单

### 对外暴露的接口
| 接口名称 | 类型 | 用途 | 契约文件 |
|---------|------|------|---------|
| User API | REST | 用户管理 | tools/user-api/contract.json |
| Task API | REST | 任务管理 | tools/task-api/contract.json |
| Webhook | Event | 事件通知 | tools/webhook/contract.json |

### 依赖的外部接口
| 接口名称 | 提供方 | 用途 | SLA |
|---------|--------|------|-----|
| SendGrid API | SendGrid | 邮件发送 | 99.9% |
| OpenAI API | OpenAI | AI 辅助 | 99% |

---

## 部署架构

```
[可选：使用 Mermaid 绘制部署架构图]

graph TB
    User[用户] --> LB[负载均衡]
    LB --> App1[应用实例1]
    LB --> App2[应用实例2]
    App1 --> DB[(主数据库)]
    App2 --> DB
    DB --> Replica[(从数据库)]
    App1 --> Cache[Redis]
    App2 --> Cache
```

---

## 变更记录

| 日期 | 版本 | 变更内容 | 审批人 |
|------|------|---------|--------|
| 2025-11-04 | 1.0 | 初始版本 | [姓名] |

---

**填写指导**：
1. 根据实际项目填写所有章节
2. 删除不适用的示例内容
3. 保持简洁但完整（4-6 页）
4. 与团队讨论并达成共识
5. 每个 Phase 结束后更新
6. 定期审查（至少每季度一次）

**相关文档**：
- `docs/project/RELEASE_TRAIN.md` - 发布计划
- `docs/db/DB_SPEC.yaml` - 数据库详细规范
- `flows/dag.yaml` - 系统 DAG 拓扑
